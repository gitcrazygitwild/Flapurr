<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" />

  <title>Flapurr! üêæ</title>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Prevent weird mobile zoom / scroll -->
  <style>
    html, body { margin: 0; padding: 0; background: #0b0f17; }
  </style>
</head>

<body>

  <div class="wrap">

    <!-- HEADER -->
    <header class="top">
      <h1>Flapurr! üê±</h1>
      <div class="hint">
        Tap to flap ‚Ä¢ Dodge scratch posts ‚Ä¢ Submit your score
      </div>
    </header>

    <!-- GAME AREA -->
    <div class="stage">
      <canvas id="c" width="420" height="640"></canvas>

      <!-- Fullscreen button -->
      <button id="fs" class="fs" type="button">‚õ∂</button>
    </div>

    <!-- LEADERBOARD + STATS -->
    <section class="panel">

      <div class="panelRow">
        <div>
          <strong>üêæ Total plays:</strong>
          <span id="plays">‚Äî</span>
        </div>

        <div>
          <strong>üèÜ Top Cats</strong>
        </div>
      </div>

      <ol id="board" class="board"></ol>

      <div class="tiny" id="netStatus">
        Connecting to cat HQ‚Ä¶
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="bottom">
      <span id="status">Ready</span>
      <span class="right">Made with üêü</span>
    </footer>

  </div>

  <!-- SCORE SUBMIT MODAL -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modalCard">

      <div class="modalTitle">
        MEOWTCH! Submit your score?
      </div>

      <div class="modalSub">
        Score: <span id="finalScore">0</span>
      </div>

      <label class="label" for="name">
        Cat name (1‚Äì16 chars)
      </label>

      <input
        id="name"
        class="input"
        maxlength="16"
        placeholder="Sir Pounce-a-lot"
      />

      <div class="modalBtns">
        <button id="submit" class="btnPrimary" type="button">
          Submit
        </button>

        <button id="skip" class="btnGhost" type="button">
          Skip
        </button>
      </div>

      <div class="tiny" id="submitStatus"></div>

    </div>
  </div>

<script>
  (function () {
    function show(msg) {
      var box = document.getElementById("errbox");
      if (!box) {
        box = document.createElement("div");
        box.id = "errbox";
        box.style.cssText =
          "position:fixed;left:8px;right:8px;top:8px;z-index:999999;" +
          "background:rgba(0,0,0,.86);color:#fff;padding:10px 12px;border-radius:12px;" +
          "font:12px/1.35 system-ui;white-space:pre-wrap;max-height:50vh;overflow:auto;";
        document.body.appendChild(box);
      }
      box.textContent = msg;
    }

    // Global JS errors
    window.addEventListener("error", function (e) {
      show("JS ERROR:\n" + (e.message || e) + "\n" + (e.filename || "") + ":" + (e.lineno || ""));
    });

    // Promise errors
    window.addEventListener("unhandledrejection", function (e) {
      show("PROMISE ERROR:\n" + (e.reason && e.reason.message ? e.reason.message : String(e.reason)));
    });

    // Resource load errors (THIS is the missing piece, capture = true)
    window.addEventListener("error", function (e) {
      var t = e.target;
      if (t && (t.tagName === "SCRIPT" || t.tagName === "LINK")) {
        show("RESOURCE ERROR:\n" + t.tagName + " failed to load\n" + (t.src || t.href || "(no url)"));
      }
    }, true);

    setTimeout(function () {
      show("Debugger loaded ‚úÖ\nWaiting for module script‚Ä¶");
    }, 300);
  })();
</script>

  <!-- GAME SCRIPT -->
  <!-- IMPORTANT: must be type="module" -->
   <script type="module">
  document.getElementById("netStatus").textContent = "INLINE MODULE RAN ‚úÖ";
</script>
<script type="module" src="game.js"></script>

</body>
</html>